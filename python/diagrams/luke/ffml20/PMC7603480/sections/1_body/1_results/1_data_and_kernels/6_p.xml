<?xml version="1.0" encoding="UTF-8"?>
<p id="Par14">To train ML models, the Rad-6 database is split into training, validation (for hyperparameter optimization) and test sets. To obtain representative training sets, we use the farthest point sampling (FPS) method
 <sup>
  <xref ref-type="bibr" rid="CR36">36</xref>
 </sup>. In FPS, data-points are sequentially selected to maximize the distance between a new data-point (a molecule 
 <italic>A</italic>) and all previously selected points (molecules 
 <italic>B</italic> already in the training set). In the present context, this means new molecules added to the training set should be as dissimilar as possible to all previously selected molecules. The distance between molecules is measured using the previously introduced kernels, according to:
 <disp-formula id="Equ5">
  <label>5</label>
  <alternatives>
   <tex-math id="M9">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$D(A,B)=\sqrt{K(A,A)+K(B,B)-2K(A,B)}.$$\end{document}</tex-math>
   <math id="M10">
    <mi>D</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>A</mi>
      <mo>,</mo>
      <mi>B</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msqrt>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>A</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>+</mo>
      <mi>K</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>B</mi>
        <mo>,</mo>
        <mi>B</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>−</mo>
      <mn>2</mn>
      <mi>K</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </msqrt>
    <mo>.</mo>
   </math>
   <graphic xlink:href="41467_2020_19267_Article_Equ5.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>Because 
 <italic>D</italic>(
 <italic>A</italic>, 
 <italic>B</italic>) depends on the kernel, we obtain different training sets for the intensive and extensive kernels. Most importantly, while we normalize 
 <italic>K</italic>
 <sub>int</sub> so that 
 <italic>K</italic>
 <sub>int</sub>(
 <italic>A</italic>, 
 <italic>A</italic>) = 
 <italic>K</italic>
 <sub>int</sub>(
 <italic>B</italic>, 
 <italic>B</italic>) = 1, 
 <italic>K</italic>
 <sub>ext</sub> is not normalized. Consequently, 
 <inline-formula id="IEq1">
  <alternatives>
   <tex-math id="M11">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${K}_{{\rm{ext}}}(A,A) \sim {N}_{A}^{2}$$\end{document}</tex-math>
   <math id="M12">
    <msub>
     <mrow>
      <mi>K</mi>
     </mrow>
     <mrow>
      <mi mathvariant="normal">ext</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>A</mi>
      <mo>,</mo>
      <mi>A</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>~</mo>
    <msubsup>
     <mrow>
      <mi>N</mi>
     </mrow>
     <mrow>
      <mi>A</mi>
     </mrow>
     <mrow>
      <mn>2</mn>
     </mrow>
    </msubsup>
   </math>
   <inline-graphic xlink:href="41467_2020_19267_Article_IEq1.gif" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </inline-formula> and 
 <inline-formula id="IEq2">
  <alternatives>
   <tex-math id="M13">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${K}_{{\rm{ext}}}(B,B) \sim {N}_{B}^{2}$$\end{document}</tex-math>
   <math id="M14">
    <msub>
     <mrow>
      <mi>K</mi>
     </mrow>
     <mrow>
      <mi mathvariant="normal">ext</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>B</mi>
      <mo>,</mo>
      <mi>B</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>~</mo>
    <msubsup>
     <mrow>
      <mi>N</mi>
     </mrow>
     <mrow>
      <mi>B</mi>
     </mrow>
     <mrow>
      <mn>2</mn>
     </mrow>
    </msubsup>
   </math>
   <inline-graphic xlink:href="41467_2020_19267_Article_IEq2.gif" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </inline-formula>. This means that the distance 
 <italic>D</italic>
 <sub>ext</sub>(
 <italic>A</italic>, 
 <italic>B</italic>) evaluated with the extensive kernels tends to be greater between large systems than the distance between small systems. Accordingly, mostly large molecules are selected during the early iterations of FPS with 
 <italic>D</italic>
 <sub>ext</sub>, whereas the intensive distance 
 <italic>D</italic>
 <sub>int</sub> maximizes the average chemical diversity in the training set irrespective of size. It should be noted that a FPS selection based on maximally diverse atomic environments rather than molecules (e.g. using a softmax criterion
 <sup>
  <xref ref-type="bibr" rid="CR54">54</xref>
 </sup>) would also be possible. This may be a better choice for datasets with large molecules.
</p>
